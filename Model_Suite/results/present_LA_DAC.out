data generated from pre-generated method
Running with:
abstain_flag True
ntask_flag False
abstain_labels [70, 309, 7, 519, 4]
abstain_alphas [0.1, 0.1, 0.1, 0.1, 0.1]
abstain_min_acc [0.975, 0.975, 0.975, 0.975, 0.975]
abstain_max_abs [0.8, 0.8, 0.5, 0.8, 0.5]
abstain_abs_gain 5.0
abstain_acc_gain 10.0
abstain_tune_mode acc
abstain_stop_limit 0.005
abstain_alpha_scale [0.8, 0.8, 0.8, 0.8, 0.8]
ntask_alpha 0.1
ntask_max_abs 0.9
ntask_min_acc 0.975
ntask_tasks ['site', 'laterality', 'histology', 'behavior']
training network on 363367 documents, validation on 77623 documents
training mthisan using 1 cuda devices
['site', 'subsite', 'laterality', 'histology', 'behavior']


training time: 597.61
        task,      micro,      macro,   abs_frac
        site,     0.9406,     0.1276,     0.6744
     subsite,     0.7762,     0.0187,     0.9015
  laterality,     0.9787,     0.4146,     0.7402
   histology,     0.6916,     0.0036,     0.9160
    behavior,     0.9862,     0.2815,     0.3496

epoch 1 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9930,     0.2859,     0.4966,     0.9750,     0.1000,     1.1796,     0.0180
     subsite,     0.9928,     0.1296,     0.8512,     0.9750,     0.1000,     1.1781,     0.0178
  laterality,     0.9856,     0.4208,     0.4613,     0.9750,     0.1000,     1.1056,     0.0106
   histology,     0.9887,     0.0765,     0.9228,     0.9750,     0.1000,     1.1366,     0.0137
    behavior,     0.9957,     0.4971,     0.1873,     0.9750,     0.1000,     1.2069,     0.0207
epoch 1
Stopping criterion not reached: 0.0207 > 0.0050
New alphas ['0.1180', '0.1178', '0.1106', '0.1137', '0.1207']


training time: 584.79
        task,      micro,      macro,   abs_frac
        site,     0.9920,     0.3061,     0.5293
     subsite,     0.9932,     0.1065,     0.8590
  laterality,     0.9828,     0.4188,     0.5236
   histology,     0.9873,     0.1546,     0.9241
    behavior,     0.9915,     0.4944,     0.1726

epoch 2 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9889,     0.4226,     0.3906,     0.9750,     0.1180,     1.1390,     0.0139
     subsite,     0.9885,     0.1600,     0.8165,     0.9750,     0.1178,     1.1349,     0.0135
  laterality,     0.9812,     0.4186,     0.3753,     0.9750,     0.1106,     1.0623,     0.0062
   histology,     0.9783,     0.1710,     0.8751,     0.9750,     0.1137,     1.0333,     0.0033
    behavior,     0.9956,     0.4999,     0.1558,     0.9750,     0.1207,     1.2056,     0.0206
epoch 2
Stopping criterion not reached: 0.0206 > 0.0050
New alphas ['0.1344', '0.1337', '0.1174', '0.1174', '0.1455']


training time: 585.95
        task,      micro,      macro,   abs_frac
        site,     0.9905,     0.3852,     0.4650
     subsite,     0.9924,     0.1326,     0.8414
  laterality,     0.9834,     0.4196,     0.4810
   histology,     0.9858,     0.1942,     0.9157
    behavior,     0.9907,     0.5477,     0.1467

epoch 3 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9883,     0.4853,     0.3624,     0.9750,     0.1344,     1.1326,     0.0133
     subsite,     0.9892,     0.2134,     0.8113,     0.9750,     0.1337,     1.1421,     0.0142
  laterality,     0.9854,     0.4210,     0.3914,     0.9750,     0.1174,     1.1035,     0.0104
   histology,     0.9786,     0.2466,     0.8708,     0.9750,     0.1174,     1.0356,     0.0036
    behavior,     0.9946,     0.6520,     0.1365,     0.9750,     0.1455,     1.1957,     0.0196
epoch 3
Stopping criterion not reached: 0.0196 > 0.0050
New alphas ['0.1522', '0.1527', '0.1296', '0.1216', '0.1740']


training time: 585.66
        task,      micro,      macro,   abs_frac
        site,     0.9893,     0.4425,     0.4236
     subsite,     0.9913,     0.1816,     0.8301
  laterality,     0.9820,     0.4190,     0.4447
   histology,     0.9853,     0.1953,     0.9114
    behavior,     0.9891,     0.5996,     0.1272

epoch 4 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9832,     0.5128,     0.3027,     0.9750,     0.1522,     1.0819,     0.0082
     subsite,     0.9817,     0.2777,     0.7893,     0.9750,     0.1527,     1.0671,     0.0067
  laterality,     0.9819,     0.4196,     0.3494,     0.9750,     0.1296,     1.0688,     0.0069
   histology,     0.9774,     0.2418,     0.8692,     0.9750,     0.1216,     1.0244,     0.0024
    behavior,     0.9925,     0.6926,     0.1097,     0.9750,     0.1740,     1.1753,     0.0175
epoch 4
Stopping criterion not reached: 0.0175 > 0.0050
New alphas ['0.1646', '0.1630', '0.1385', '0.1246', '0.2045']


training time: 581.28
        task,      micro,      macro,   abs_frac
        site,     0.9879,     0.4839,     0.3968
     subsite,     0.9889,     0.2305,     0.8202
  laterality,     0.9812,     0.4188,     0.4203
   histology,     0.9836,     0.2100,     0.9069
    behavior,     0.9862,     0.6408,     0.1065

epoch 5 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9833,     0.5577,     0.2897,     0.9750,     0.1646,     1.0833,     0.0083
     subsite,     0.9826,     0.3196,     0.7792,     0.9750,     0.1630,     1.0756,     0.0076
  laterality,     0.9838,     0.4206,     0.3524,     0.9750,     0.1385,     1.0879,     0.0088
   histology,     0.9749,     0.2624,     0.8526,     0.9750,     0.1246,     0.9992,    -0.0001
    behavior,     0.9923,     0.7022,     0.1004,     0.9750,     0.2045,     1.1727,     0.0173
epoch 5
Stopping criterion not reached: 0.0173 > 0.0050
New alphas ['0.1784', '0.1753', '0.1507', '0.1245', '0.2398']


training time: 587.04
        task,      micro,      macro,   abs_frac
        site,     0.9868,     0.5102,     0.3748
     subsite,     0.9873,     0.2084,     0.8122
  laterality,     0.9799,     0.4182,     0.3962
   histology,     0.9836,     0.2115,     0.9039
    behavior,     0.9826,     0.6601,     0.0851

epoch 6 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9781,     0.5423,     0.2439,     0.9750,     0.1784,     1.0312,     0.0031
     subsite,     0.9767,     0.2871,     0.7576,     0.9750,     0.1753,     1.0173,     0.0017
  laterality,     0.9806,     0.4191,     0.3231,     0.9750,     0.1507,     1.0561,     0.0056
   histology,     0.9619,     0.2214,     0.7919,     0.9750,     0.1245,     0.8693,    -0.0131
    behavior,     0.9875,     0.7170,     0.0664,     0.9750,     0.2398,     1.1253,     0.0125
epoch 6
Stopping criterion not reached: 0.0131 > 0.0050
New alphas ['0.1839', '0.1783', '0.1591', '0.1082', '0.2698']


training time: 583.61
        task,      micro,      macro,   abs_frac
        site,     0.9865,     0.5251,     0.3611
     subsite,     0.9869,     0.2401,     0.8062
  laterality,     0.9792,     0.4179,     0.3802
   histology,     0.9850,     0.2380,     0.9080
    behavior,     0.9786,     0.6662,     0.0654

epoch 7 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9793,     0.5631,     0.2408,     0.9750,     0.1839,     1.0431,     0.0043
     subsite,     0.9776,     0.2905,     0.7500,     0.9750,     0.1783,     1.0264,     0.0026
  laterality,     0.9774,     0.4176,     0.2719,     0.9750,     0.1591,     1.0242,     0.0024
   histology,     0.9732,     0.2836,     0.8450,     0.9750,     0.1082,     0.9816,    -0.0018
    behavior,     0.9853,     0.7085,     0.0550,     0.9750,     0.2698,     1.1028,     0.0103
epoch 7
Stopping criterion not reached: 0.0103 > 0.0050
New alphas ['0.1919', '0.1830', '0.1630', '0.1062', '0.2975']


training time: 585.11
        task,      micro,      macro,   abs_frac
        site,     0.9858,     0.5380,     0.3488
     subsite,     0.9855,     0.2616,     0.7978
  laterality,     0.9790,     0.4178,     0.3684
   histology,     0.9864,     0.2521,     0.9075
    behavior,     0.9749,     0.6726,     0.0489

epoch 8 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9798,     0.5849,     0.2451,     0.9750,     0.1919,     1.0476,     0.0048
     subsite,     0.9740,     0.3164,     0.7345,     0.9750,     0.1830,     0.9899,    -0.0010
  laterality,     0.9784,     0.4183,     0.2770,     0.9750,     0.1630,     1.0342,     0.0034
   histology,     0.9746,     0.2865,     0.8399,     0.9750,     0.1062,     0.9957,    -0.0004
    behavior,     0.9819,     0.7094,     0.0399,     0.9750,     0.2975,     1.0686,     0.0069
epoch 8
Stopping criterion not reached: 0.0069 > 0.0050
New alphas ['0.2010', '0.1812', '0.1686', '0.1058', '0.3180']


training time: 586.46
        task,      micro,      macro,   abs_frac
        site,     0.9848,     0.5559,     0.3369
     subsite,     0.9850,     0.2807,     0.7931
  laterality,     0.9781,     0.4174,     0.3560
   histology,     0.9855,     0.2436,     0.9064
    behavior,     0.9723,     0.6781,     0.0365

epoch 9 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9785,     0.5892,     0.2362,     0.9750,     0.2010,     1.0351,     0.0035
     subsite,     0.9762,     0.3045,     0.7355,     0.9750,     0.1812,     1.0119,     0.0012
  laterality,     0.9791,     0.4186,     0.2731,     0.9750,     0.1686,     1.0414,     0.0041
   histology,     0.9732,     0.2732,     0.8221,     0.9750,     0.1058,     0.9820,    -0.0018
    behavior,     0.9819,     0.7017,     0.0398,     0.9750,     0.3180,     1.0687,     0.0069
epoch 9
Stopping criterion not reached: 0.0069 > 0.0050
New alphas ['0.2081', '0.1833', '0.1756', '0.1039', '0.3398']


training time: 579.26
        task,      micro,      macro,   abs_frac
        site,     0.9843,     0.5660,     0.3274
     subsite,     0.9844,     0.2754,     0.7890
  laterality,     0.9771,     0.4168,     0.3452
   histology,     0.9872,     0.2846,     0.9062
    behavior,     0.9695,     0.6870,     0.0263

epoch 10 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9793,     0.6121,     0.2337,     0.9750,     0.2081,     1.0425,     0.0043
     subsite,     0.9737,     0.3266,     0.7264,     0.9750,     0.1833,     0.9868,    -0.0013
  laterality,     0.9808,     0.4194,     0.2867,     0.9750,     0.1756,     1.0584,     0.0058
   histology,     0.9715,     0.2902,     0.8297,     0.9750,     0.1039,     0.9649,    -0.0035
    behavior,     0.9778,     0.6998,     0.0225,     0.9750,     0.3398,     1.0285,     0.0028
epoch 10
Stopping criterion not reached: 0.0058 > 0.0050
New alphas ['0.2169', '0.1809', '0.1858', '0.1002', '0.3495']


training time: 614.27
        task,      micro,      macro,   abs_frac
        site,     0.9835,     0.5711,     0.3172
     subsite,     0.9843,     0.2973,     0.7861
  laterality,     0.9759,     0.4163,     0.3285
   histology,     0.9866,     0.3038,     0.9067
    behavior,     0.9690,     0.6981,     0.0222

epoch 11 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9789,     0.6071,     0.2304,     0.9750,     0.2169,     1.0394,     0.0039
     subsite,     0.9740,     0.3459,     0.7241,     0.9750,     0.1809,     0.9904,    -0.0010
  laterality,     0.9779,     0.4178,     0.2604,     0.9750,     0.1858,     1.0291,     0.0029
   histology,     0.9745,     0.2785,     0.8378,     0.9750,     0.1002,     0.9950,    -0.0005
    behavior,     0.9769,     0.7520,     0.0200,     0.9750,     0.3495,     1.0194,     0.0019
epoch 11
Stopping criterion reached: 0.0039 < 0.0050
Testing best saved model

file has been saved at savedmodels/../DAC_current/LA_modelfold0.h5
saving f1 scores to predictions/LA_modelfold0_scores.csv

train scores:
        task,      micro,      macro,   abs_frac
        site,     0.9850,     0.5859,     0.3124
     subsite,     0.9862,     0.3021,     0.7828
  laterality,     0.9792,     0.4179,     0.3378
   histology,     0.9882,     0.2552,     0.9041
    behavior,     0.9747,     0.7382,     0.0351

val scores:
        task,      micro,      macro,   abs_frac
        site,     0.9789,     0.6071,     0.2304
     subsite,     0.9740,     0.3459,     0.7241
  laterality,     0.9779,     0.4178,     0.2604
   histology,     0.9745,     0.2785,     0.8378
    behavior,     0.9769,     0.7520,     0.0200

test scores:
        task,      micro,      macro,   abs_frac
        site,     0.9817,     0.6360,     0.2017
     subsite,     0.9761,     0.3765,     0.7102
  laterality,     0.9806,     0.4193,     0.2404
   histology,     0.9882,     0.3720,     0.8207
    behavior,     0.9795,     0.7765,     0.0163
writing csv
f1 scores have been saved to predictions/LA_modelfold0_scores.csv
saving full results to predictions/LA_modelfold0_*



writing csvs
files have been saved to this directory under the names predictions/LA_modelfold0_*
