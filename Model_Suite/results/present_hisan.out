data generated from pre-generated method
training network on 363367 documents, validation on 77623 documents
training mthisan using 1 cuda devices
['site', 'subsite', 'laterality', 'histology', 'behavior']


training time: 534.52
        task,      micro,      macro
        site,     0.7780,     0.3241
     subsite,     0.4424,     0.0737
  laterality,     0.8244,     0.3750
   histology,     0.5675,     0.0271
    behavior,     0.9220,     0.5050

epoch 1 validation
        task,      micro,      macro
        site,     0.8804,     0.4770
     subsite,     0.5456,     0.1293
  laterality,     0.8926,     0.4572
   histology,     0.6666,     0.0641
    behavior,     0.9514,     0.6429
epoch 1 val loss: 0.76333249, best val loss: inf
patience counter is at 0 of 5


training time: 534.64
        task,      micro,      macro
        site,     0.8540,     0.4520
     subsite,     0.5251,     0.1250
  laterality,     0.8657,     0.4241
   histology,     0.6450,     0.0521
    behavior,     0.9431,     0.6205

epoch 2 validation
        task,      micro,      macro
        site,     0.8895,     0.5236
     subsite,     0.5719,     0.1704
  laterality,     0.8953,     0.4809
   histology,     0.7005,     0.0972
    behavior,     0.9629,     0.6936
epoch 2 val loss: 0.68776220, best val loss: 0.76333249
patience counter is at 0 of 5


training time: 528.82
        task,      micro,      macro
        site,     0.8633,     0.4886
     subsite,     0.5451,     0.1503
  laterality,     0.8690,     0.4299
   histology,     0.6660,     0.0741
    behavior,     0.9488,     0.6489

epoch 3 validation
        task,      micro,      macro
        site,     0.8948,     0.5577
     subsite,     0.5831,     0.2022
  laterality,     0.8986,     0.4940
   histology,     0.7162,     0.1312
    behavior,     0.9609,     0.6852
epoch 3 val loss: 0.65616202, best val loss: 0.68776220
patience counter is at 0 of 5


training time: 531.81
        task,      micro,      macro
        site,     0.8684,     0.5124
     subsite,     0.5566,     0.1687
  laterality,     0.8719,     0.4343
   histology,     0.6783,     0.0918
    behavior,     0.9518,     0.6602

epoch 4 validation
        task,      micro,      macro
        site,     0.8965,     0.5828
     subsite,     0.5898,     0.2180
  laterality,     0.8999,     0.4886
   histology,     0.7273,     0.1626
    behavior,     0.9639,     0.7184
epoch 4 val loss: 0.63718921, best val loss: 0.65616202
patience counter is at 0 of 5


training time: 530.59
        task,      micro,      macro
        site,     0.8712,     0.5263
     subsite,     0.5618,     0.1811
  laterality,     0.8732,     0.4408
   histology,     0.6869,     0.1094
    behavior,     0.9539,     0.6707

epoch 5 validation
        task,      micro,      macro
        site,     0.8985,     0.5945
     subsite,     0.5933,     0.2294
  laterality,     0.9007,     0.4983
   histology,     0.7351,     0.1782
    behavior,     0.9628,     0.7164
epoch 5 val loss: 0.62667865, best val loss: 0.63718921
patience counter is at 0 of 5


training time: 531.42
        task,      micro,      macro
        site,     0.8745,     0.5385
     subsite,     0.5677,     0.1914
  laterality,     0.8742,     0.4406
   histology,     0.6935,     0.1230
    behavior,     0.9553,     0.6816

epoch 6 validation
        task,      micro,      macro
        site,     0.8999,     0.6117
     subsite,     0.5980,     0.2392
  laterality,     0.9028,     0.5039
   histology,     0.7387,     0.1983
    behavior,     0.9665,     0.7053
epoch 6 val loss: 0.61422968, best val loss: 0.62667865
patience counter is at 0 of 5


training time: 528.56
        task,      micro,      macro
        site,     0.8763,     0.5455
     subsite,     0.5735,     0.2011
  laterality,     0.8765,     0.4466
   histology,     0.6970,     0.1347
    behavior,     0.9569,     0.6931

epoch 7 validation
        task,      micro,      macro
        site,     0.9011,     0.6178
     subsite,     0.6030,     0.2466
  laterality,     0.9018,     0.4899
   histology,     0.7424,     0.2116
    behavior,     0.9672,     0.7133
epoch 7 val loss: 0.60750842, best val loss: 0.61422968
patience counter is at 0 of 5


training time: 532.26
        task,      micro,      macro
        site,     0.8778,     0.5528
     subsite,     0.5775,     0.2052
  laterality,     0.8771,     0.4477
   histology,     0.7008,     0.1431
    behavior,     0.9577,     0.7026

epoch 8 validation
        task,      micro,      macro
        site,     0.9018,     0.6142
     subsite,     0.6068,     0.2543
  laterality,     0.9028,     0.5049
   histology,     0.7463,     0.2248
    behavior,     0.9661,     0.7558
epoch 8 val loss: 0.60235053, best val loss: 0.60750842
patience counter is at 0 of 5


training time: 528.93
        task,      micro,      macro
        site,     0.8796,     0.5629
     subsite,     0.5811,     0.2120
  laterality,     0.8779,     0.4515
   histology,     0.7034,     0.1514
    behavior,     0.9581,     0.7060

epoch 9 validation
        task,      micro,      macro
        site,     0.9029,     0.6235
     subsite,     0.6100,     0.2622
  laterality,     0.9041,     0.4899
   histology,     0.7472,     0.2346
    behavior,     0.9675,     0.7350
epoch 9 val loss: 0.59745365, best val loss: 0.60235053
patience counter is at 0 of 5


training time: 528.32
        task,      micro,      macro
        site,     0.8798,     0.5649
     subsite,     0.5831,     0.2162
  laterality,     0.8781,     0.4543
   histology,     0.7057,     0.1596
    behavior,     0.9588,     0.7063

epoch 10 validation
        task,      micro,      macro
        site,     0.9031,     0.6261
     subsite,     0.6103,     0.2649
  laterality,     0.9033,     0.5015
   histology,     0.7506,     0.2424
    behavior,     0.9679,     0.7729
epoch 10 val loss: 0.59339154, best val loss: 0.59745365
patience counter is at 0 of 5


training time: 531.88
        task,      micro,      macro
        site,     0.8817,     0.5671
     subsite,     0.5865,     0.2236
  laterality,     0.8782,     0.4525
   histology,     0.7086,     0.1667
    behavior,     0.9592,     0.7144

epoch 11 validation
        task,      micro,      macro
        site,     0.9040,     0.6286
     subsite,     0.6170,     0.2754
  laterality,     0.9039,     0.5024
   histology,     0.7516,     0.2486
    behavior,     0.9691,     0.7395
epoch 11 val loss: 0.58933103, best val loss: 0.59339154
patience counter is at 0 of 5


training time: 539.34
        task,      micro,      macro
        site,     0.8825,     0.5761
     subsite,     0.5887,     0.2273
  laterality,     0.8791,     0.4598
   histology,     0.7100,     0.1732
    behavior,     0.9596,     0.7351

epoch 12 validation
        task,      micro,      macro
        site,     0.9042,     0.6293
     subsite,     0.6163,     0.2783
  laterality,     0.9048,     0.5093
   histology,     0.7529,     0.2507
    behavior,     0.9688,     0.7561
epoch 12 val loss: 0.58592737, best val loss: 0.58933103
patience counter is at 0 of 5


training time: 532.38
        task,      micro,      macro
        site,     0.8831,     0.5787
     subsite,     0.5919,     0.2311
  laterality,     0.8797,     0.4565
   histology,     0.7118,     0.1765
    behavior,     0.9603,     0.7365

epoch 13 validation
        task,      micro,      macro
        site,     0.9049,     0.6351
     subsite,     0.6225,     0.2812
  laterality,     0.9043,     0.5113
   histology,     0.7549,     0.2591
    behavior,     0.9683,     0.7646
epoch 13 val loss: 0.58261949, best val loss: 0.58592737
patience counter is at 0 of 5


training time: 528.96
        task,      micro,      macro
        site,     0.8837,     0.5783
     subsite,     0.5942,     0.2335
  laterality,     0.8795,     0.4566
   histology,     0.7128,     0.1824
    behavior,     0.9604,     0.7411

epoch 14 validation
        task,      micro,      macro
        site,     0.9044,     0.6413
     subsite,     0.6245,     0.2890
  laterality,     0.9046,     0.5097
   histology,     0.7542,     0.2578
    behavior,     0.9692,     0.7830
epoch 14 val loss: 0.57986075, best val loss: 0.58261949
patience counter is at 0 of 5


training time: 528.99
        task,      micro,      macro
        site,     0.8846,     0.5865
     subsite,     0.5965,     0.2399
  laterality,     0.8799,     0.4576
   histology,     0.7146,     0.1875
    behavior,     0.9605,     0.7422

epoch 15 validation
        task,      micro,      macro
        site,     0.9052,     0.6388
     subsite,     0.6263,     0.2890
  laterality,     0.9055,     0.5060
   histology,     0.7570,     0.2641
    behavior,     0.9689,     0.7953
epoch 15 val loss: 0.57848406, best val loss: 0.57986075
patience counter is at 0 of 5


training time: 533.11
        task,      micro,      macro
        site,     0.8849,     0.5878
     subsite,     0.5983,     0.2451
  laterality,     0.8805,     0.4589
   histology,     0.7161,     0.1921
    behavior,     0.9610,     0.7589

epoch 16 validation
        task,      micro,      macro
        site,     0.9050,     0.6388
     subsite,     0.6276,     0.2937
  laterality,     0.9048,     0.5087
   histology,     0.7560,     0.2644
    behavior,     0.9694,     0.7969
epoch 16 val loss: 0.57797784, best val loss: 0.57848406
patience counter is at 0 of 5


training time: 528.52
        task,      micro,      macro
        site,     0.8853,     0.5903
     subsite,     0.5995,     0.2453
  laterality,     0.8802,     0.4602
   histology,     0.7171,     0.1959
    behavior,     0.9611,     0.7628

epoch 17 validation
        task,      micro,      macro
        site,     0.9064,     0.6420
     subsite,     0.6293,     0.2929
  laterality,     0.9050,     0.5129
   histology,     0.7573,     0.2764
    behavior,     0.9682,     0.7949
epoch 17 val loss: 0.57627213, best val loss: 0.57797784
patience counter is at 0 of 5


training time: 532.60
        task,      micro,      macro
        site,     0.8864,     0.5885
     subsite,     0.6012,     0.2482
  laterality,     0.8808,     0.4604
   histology,     0.7172,     0.2017
    behavior,     0.9615,     0.7667

epoch 18 validation
        task,      micro,      macro
        site,     0.9058,     0.6411
     subsite,     0.6290,     0.2988
  laterality,     0.9051,     0.5107
   histology,     0.7584,     0.2720
    behavior,     0.9694,     0.7902
epoch 18 val loss: 0.57385242, best val loss: 0.57627213
patience counter is at 0 of 5


training time: 540.27
        task,      micro,      macro
        site,     0.8872,     0.5958
     subsite,     0.6024,     0.2522
  laterality,     0.8813,     0.4622
   histology,     0.7183,     0.2038
    behavior,     0.9615,     0.7650

epoch 19 validation
        task,      micro,      macro
        site,     0.9059,     0.6414
     subsite,     0.6289,     0.2942
  laterality,     0.9050,     0.5089
   histology,     0.7583,     0.2765
    behavior,     0.9698,     0.8097
epoch 19 val loss: 0.57236618, best val loss: 0.57385242
patience counter is at 0 of 5


training time: 531.96
        task,      micro,      macro
        site,     0.8875,     0.5958
     subsite,     0.6032,     0.2559
  laterality,     0.8814,     0.4626
   histology,     0.7199,     0.2072
    behavior,     0.9617,     0.7771

epoch 20 validation
        task,      micro,      macro
        site,     0.9064,     0.6436
     subsite,     0.6295,     0.2968
  laterality,     0.9054,     0.5145
   histology,     0.7581,     0.2806
    behavior,     0.9696,     0.8122
epoch 20 val loss: 0.57235157, best val loss: 0.57236618
patience counter is at 0 of 5


training time: 528.97
        task,      micro,      macro
        site,     0.8877,     0.5977
     subsite,     0.6036,     0.2599
  laterality,     0.8814,     0.4615
   histology,     0.7204,     0.2107
    behavior,     0.9613,     0.7766

epoch 21 validation
        task,      micro,      macro
        site,     0.9067,     0.6447
     subsite,     0.6300,     0.3006
  laterality,     0.9059,     0.5114
   histology,     0.7587,     0.2789
    behavior,     0.9700,     0.8106
epoch 21 val loss: 0.57093674, best val loss: 0.57235157
patience counter is at 0 of 5


training time: 529.11
        task,      micro,      macro
        site,     0.8884,     0.5995
     subsite,     0.6043,     0.2577
  laterality,     0.8818,     0.4644
   histology,     0.7214,     0.2140
    behavior,     0.9619,     0.7813

epoch 22 validation
        task,      micro,      macro
        site,     0.9071,     0.6495
     subsite,     0.6314,     0.2988
  laterality,     0.9056,     0.5170
   histology,     0.7593,     0.2821
    behavior,     0.9696,     0.8065
epoch 22 val loss: 0.57056195, best val loss: 0.57093674
patience counter is at 0 of 5


training time: 529.90
        task,      micro,      macro
        site,     0.8882,     0.6019
     subsite,     0.6052,     0.2632
  laterality,     0.8812,     0.4611
   histology,     0.7218,     0.2155
    behavior,     0.9624,     0.7745

epoch 23 validation
        task,      micro,      macro
        site,     0.9064,     0.6445
     subsite,     0.6304,     0.3070
  laterality,     0.9062,     0.5218
   histology,     0.7587,     0.2841
    behavior,     0.9695,     0.8288
epoch 23 val loss: 0.57093722, best val loss: 0.57056195
patience counter is at 1 of 5


training time: 530.13
        task,      micro,      macro
        site,     0.8888,     0.6031
     subsite,     0.6058,     0.2648
  laterality,     0.8822,     0.4670
   histology,     0.7227,     0.2224
    behavior,     0.9623,     0.7874

epoch 24 validation
        task,      micro,      macro
        site,     0.9067,     0.6494
     subsite,     0.6330,     0.3053
  laterality,     0.9065,     0.5143
   histology,     0.7610,     0.2911
    behavior,     0.9707,     0.8356
epoch 24 val loss: 0.56784022, best val loss: 0.57056195
patience counter is at 0 of 5


training time: 527.72
        task,      micro,      macro
        site,     0.8888,     0.6071
     subsite,     0.6065,     0.2680
  laterality,     0.8821,     0.4645
   histology,     0.7223,     0.2245
    behavior,     0.9623,     0.7839

epoch 25 validation
        task,      micro,      macro
        site,     0.9065,     0.6434
     subsite,     0.6264,     0.3048
  laterality,     0.9053,     0.5131
   histology,     0.7621,     0.2947
    behavior,     0.9700,     0.8285
epoch 25 val loss: 0.56925774, best val loss: 0.56784022
patience counter is at 1 of 5


training time: 527.24
        task,      micro,      macro
        site,     0.8894,     0.6076
     subsite,     0.6071,     0.2696
  laterality,     0.8822,     0.4715
   histology,     0.7236,     0.2261
    behavior,     0.9626,     0.7915

epoch 26 validation
        task,      micro,      macro
        site,     0.9075,     0.6533
     subsite,     0.6327,     0.3095
  laterality,     0.9060,     0.5140
   histology,     0.7613,     0.3005
    behavior,     0.9703,     0.8265
epoch 26 val loss: 0.56680411, best val loss: 0.56784022
patience counter is at 0 of 5


training time: 528.12
        task,      micro,      macro
        site,     0.8899,     0.6079
     subsite,     0.6085,     0.2719
  laterality,     0.8821,     0.4675
   histology,     0.7247,     0.2282
    behavior,     0.9628,     0.7995

epoch 27 validation
        task,      micro,      macro
        site,     0.9076,     0.6528
     subsite,     0.6325,     0.3124
  laterality,     0.9056,     0.5171
   histology,     0.7621,     0.2973
    behavior,     0.9709,     0.8387
epoch 27 val loss: 0.56618184, best val loss: 0.56680411
patience counter is at 0 of 5


training time: 532.65
        task,      micro,      macro
        site,     0.8904,     0.6100
     subsite,     0.6090,     0.2752
  laterality,     0.8829,     0.4663
   histology,     0.7254,     0.2313
    behavior,     0.9630,     0.7992

epoch 28 validation
        task,      micro,      macro
        site,     0.9074,     0.6497
     subsite,     0.6333,     0.3119
  laterality,     0.9051,     0.5106
   histology,     0.7611,     0.3007
    behavior,     0.9687,     0.8259
epoch 28 val loss: 0.56763870, best val loss: 0.56618184
patience counter is at 1 of 5


training time: 532.55
        task,      micro,      macro
        site,     0.8901,     0.6141
     subsite,     0.6101,     0.2775
  laterality,     0.8825,     0.4668
   histology,     0.7261,     0.2352
    behavior,     0.9629,     0.7892

epoch 29 validation
        task,      micro,      macro
        site,     0.9078,     0.6521
     subsite,     0.6335,     0.3118
  laterality,     0.9069,     0.5208
   histology,     0.7640,     0.3001
    behavior,     0.9708,     0.8352
epoch 29 val loss: 0.56335557, best val loss: 0.56618184
patience counter is at 0 of 5


training time: 529.57
        task,      micro,      macro
        site,     0.8907,     0.6174
     subsite,     0.6109,     0.2784
  laterality,     0.8833,     0.4695
   histology,     0.7266,     0.2378
    behavior,     0.9629,     0.7908

epoch 30 validation
        task,      micro,      macro
        site,     0.9079,     0.6549
     subsite,     0.6347,     0.3135
  laterality,     0.9056,     0.5118
   histology,     0.7629,     0.3051
    behavior,     0.9698,     0.8382
epoch 30 val loss: 0.56485808, best val loss: 0.56335557
patience counter is at 1 of 5


training time: 530.02
        task,      micro,      macro
        site,     0.8906,     0.6101
     subsite,     0.6101,     0.2817
  laterality,     0.8822,     0.4697
   histology,     0.7271,     0.2369
    behavior,     0.9629,     0.7953

epoch 31 validation
        task,      micro,      macro
        site,     0.9085,     0.6561
     subsite,     0.6352,     0.3152
  laterality,     0.9065,     0.5138
   histology,     0.7619,     0.3055
    behavior,     0.9709,     0.8383
epoch 31 val loss: 0.56284457, best val loss: 0.56335557
patience counter is at 0 of 5


training time: 529.15
        task,      micro,      macro
        site,     0.8911,     0.6139
     subsite,     0.6121,     0.2797
  laterality,     0.8832,     0.4696
   histology,     0.7286,     0.2389
    behavior,     0.9630,     0.7996

epoch 32 validation
        task,      micro,      macro
        site,     0.9076,     0.6524
     subsite,     0.6354,     0.3156
  laterality,     0.9062,     0.5147
   histology,     0.7627,     0.3067
    behavior,     0.9703,     0.8396
epoch 32 val loss: 0.56289506, best val loss: 0.56284457
patience counter is at 1 of 5


training time: 529.72
        task,      micro,      macro
        site,     0.8918,     0.6157
     subsite,     0.6127,     0.2838
  laterality,     0.8837,     0.4689
   histology,     0.7276,     0.2416
    behavior,     0.9629,     0.7970

epoch 33 validation
        task,      micro,      macro
        site,     0.9077,     0.6512
     subsite,     0.6338,     0.3096
  laterality,     0.9059,     0.5291
   histology,     0.7628,     0.3050
    behavior,     0.9703,     0.8313
epoch 33 val loss: 0.56363845, best val loss: 0.56284457
patience counter is at 2 of 5


training time: 529.70
        task,      micro,      macro
        site,     0.8915,     0.6169
     subsite,     0.6127,     0.2851
  laterality,     0.8833,     0.4746
   histology,     0.7285,     0.2444
    behavior,     0.9630,     0.7989

epoch 34 validation
        task,      micro,      macro
        site,     0.9081,     0.6546
     subsite,     0.6346,     0.3175
  laterality,     0.9046,     0.5172
   histology,     0.7634,     0.3097
    behavior,     0.9702,     0.8316
epoch 34 val loss: 0.56430143, best val loss: 0.56284457
patience counter is at 3 of 5


training time: 528.83
        task,      micro,      macro
        site,     0.8919,     0.6205
     subsite,     0.6136,     0.2855
  laterality,     0.8833,     0.4649
   histology,     0.7291,     0.2503
    behavior,     0.9633,     0.8038

epoch 35 validation
        task,      micro,      macro
        site,     0.9084,     0.6539
     subsite,     0.6360,     0.3168
  laterality,     0.9063,     0.5193
   histology,     0.7639,     0.3106
    behavior,     0.9707,     0.8418
epoch 35 val loss: 0.56317604, best val loss: 0.56284457
patience counter is at 4 of 5


training time: 529.14
        task,      micro,      macro
        site,     0.8926,     0.6237
     subsite,     0.6142,     0.2925
  laterality,     0.8834,     0.4727
   histology,     0.7291,     0.2519
    behavior,     0.9636,     0.8057

epoch 36 validation
        task,      micro,      macro
        site,     0.9077,     0.6499
     subsite,     0.6364,     0.3176
  laterality,     0.9056,     0.5167
   histology,     0.7620,     0.3130
    behavior,     0.9700,     0.8322
epoch 36 val loss: 0.56356263, best val loss: 0.56284457
Testing best saved model

file has been saved at savedmodels/../ntask_current/LA_modelfold0.h5
saving f1 scores to predictions/LA_modelfold0_scores.csv

train scores:
        task,      micro,      macro
        site,     0.8956,     0.6406
     subsite,     0.6207,     0.3050
  laterality,     0.8860,     0.4863
   histology,     0.7365,     0.2722
    behavior,     0.9660,     0.8341

val scores:
        task,      micro,      macro
        site,     0.9085,     0.6561
     subsite,     0.6352,     0.3152
  laterality,     0.9065,     0.5138
   histology,     0.7619,     0.3055
    behavior,     0.9709,     0.8383

test scores:
        task,      micro,      macro
        site,     0.9199,     0.6666
     subsite,     0.6589,     0.3185
  laterality,     0.9168,     0.5309
   histology,     0.7668,     0.2971
    behavior,     0.9752,     0.8608
writing csv
f1 scores have been saved to predictions/LA_modelfold0_scores.csv
saving full results to predictions/LA_modelfold0_*



writing csvs
files have been saved to this directory under the names predictions/LA_modelfold0_*
