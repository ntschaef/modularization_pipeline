data generated from pre-generated method
Running with:
abstain_flag True
ntask_flag True
abstain_labels [70, 309, 7, 519, 4]
abstain_alphas [0.1, 0.1, 0.1, 0.1, 0.1]
abstain_min_acc [0.975, 0.975, 0.975, 0.975, 0.975]
abstain_max_abs [0.8, 0.8, 0.5, 0.8, 0.5]
abstain_abs_gain 5.0
abstain_acc_gain 10.0
abstain_tune_mode acc
abstain_stop_limit 0.005
abstain_alpha_scale [0.8, 0.8, 0.8, 0.8, 0.8]
ntask_alpha 0.1
ntask_max_abs 0.9
ntask_min_acc 0.975
ntask_tasks ['site', 'laterality', 'histology', 'behavior']
training network on 363367 documents, validation on 77623 documents
training mthisan using 1 cuda devices
['site', 'subsite', 'laterality', 'histology', 'behavior']


training time: 574.42
        task,      micro,      macro,   abs_frac
        site,     0.9205,     0.1187,     0.6891
     subsite,     0.7199,     0.0147,     0.9060
  laterality,     0.9704,     0.4106,     0.7618
   histology,     0.6534,     0.0027,     0.9158
    behavior,     0.9868,     0.2518,     0.3858
       ntask,     0.9844,     0.9844,     0.9691

epoch 1 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9934,     0.3198,     0.5120,     0.9750,     0.1000,     1.1843,     0.0184
     subsite,     0.9940,     0.1462,     0.8611,     0.9750,     0.1000,     1.1897,     0.0190
  laterality,     0.9869,     0.4918,     0.4647,     0.9750,     0.1000,     1.1188,     0.0119
   histology,     0.9893,     0.3027,     0.9245,     0.9750,     0.1000,     1.1425,     0.0143
    behavior,     0.9950,     0.2494,     0.1796,     0.9750,     0.1000,     1.2002,     0.0200
       ntask,     0.9883,     0.9883,     0.9327,     0.9750,     0.1000,     1.1332,     0.0133
epoch 1
Stopping criterion not reached: 0.0200 > 0.0050
New alphas ['0.1184', '0.1190', '0.1119', '0.1143', '0.1200']
New ntask alpha ['0.1133']


training time: 563.41
        task,      micro,      macro,   abs_frac
        site,     0.9920,     0.2910,     0.5312
     subsite,     0.9932,     0.1063,     0.8614
  laterality,     0.9830,     0.4190,     0.5238
   histology,     0.9871,     0.1334,     0.9224
    behavior,     0.9916,     0.4840,     0.1747
       ntask,     0.9862,     0.9862,     0.9412

epoch 2 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9872,     0.3773,     0.3686,     0.9750,     0.1184,     1.1221,     0.0122
     subsite,     0.9901,     0.1566,     0.8213,     0.9750,     0.1190,     1.1512,     0.0151
  laterality,     0.9838,     0.4201,     0.4197,     0.9750,     0.1119,     1.0882,     0.0088
   histology,     0.9795,     0.1619,     0.8898,     0.9750,     0.1143,     1.0453,     0.0045
    behavior,     0.9957,     0.4989,     0.1638,     0.9750,     0.1200,     1.2073,     0.0207
       ntask,     0.9872,     0.9872,     0.9236,     0.9750,     0.1133,     1.1218,     0.0122
epoch 2
Stopping criterion not reached: 0.0207 > 0.0050
New alphas ['0.1329', '0.1370', '0.1217', '0.1194', '0.1449']
New ntask alpha ['0.1271']


training time: 562.24
        task,      micro,      macro,   abs_frac
        site,     0.9903,     0.4000,     0.4656
     subsite,     0.9921,     0.1426,     0.8421
  laterality,     0.9815,     0.4184,     0.4762
   histology,     0.9853,     0.1855,     0.9145
    behavior,     0.9907,     0.5167,     0.1481
       ntask,     0.9860,     0.9860,     0.9328

epoch 3 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9859,     0.4442,     0.3362,     0.9750,     0.1329,     1.1093,     0.0109
     subsite,     0.9847,     0.1990,     0.8022,     0.9750,     0.1370,     1.0970,     0.0097
  laterality,     0.9846,     0.4208,     0.3854,     0.9750,     0.1217,     1.0964,     0.0096
   histology,     0.9783,     0.2694,     0.8688,     0.9750,     0.1194,     1.0330,     0.0033
    behavior,     0.9955,     0.5680,     0.1465,     0.9750,     0.1449,     1.2046,     0.0205
       ntask,     0.9855,     0.9855,     0.9165,     0.9750,     0.1271,     1.1050,     0.0105
epoch 3
Stopping criterion not reached: 0.0205 > 0.0050
New alphas ['0.1474', '0.1502', '0.1335', '0.1234', '0.1745']
New ntask alpha ['0.1405']


training time: 560.47
        task,      micro,      macro,   abs_frac
        site,     0.9892,     0.4370,     0.4269
     subsite,     0.9909,     0.1758,     0.8306
  laterality,     0.9806,     0.4183,     0.4403
   histology,     0.9836,     0.1957,     0.9072
    behavior,     0.9888,     0.5873,     0.1279
       ntask,     0.9857,     0.9857,     0.9302

epoch 4 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9849,     0.5414,     0.3119,     0.9750,     0.1474,     1.0995,     0.0099
     subsite,     0.9838,     0.2818,     0.7891,     0.9750,     0.1502,     1.0881,     0.0088
  laterality,     0.9810,     0.4192,     0.3225,     0.9750,     0.1335,     1.0600,     0.0060
   histology,     0.9728,     0.2441,     0.8303,     0.9750,     0.1234,     0.9783,    -0.0022
    behavior,     0.9948,     0.6520,     0.1353,     0.9750,     0.1745,     1.1980,     0.0198
       ntask,     0.9818,     0.9818,     0.9068,     0.9750,     0.1405,     1.0676,     0.0068
epoch 4
Stopping criterion not reached: 0.0198 > 0.0050
New alphas ['0.1621', '0.1635', '0.1415', '0.1207', '0.2091']
New ntask alpha ['0.1500']


training time: 562.34
        task,      micro,      macro,   abs_frac
        site,     0.9882,     0.4900,     0.3972
     subsite,     0.9889,     0.2192,     0.8205
  laterality,     0.9800,     0.4180,     0.4148
   histology,     0.9837,     0.2040,     0.9027
    behavior,     0.9859,     0.6349,     0.1071
       ntask,     0.9853,     0.9853,     0.9254

epoch 5 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9839,     0.5399,     0.2962,     0.9750,     0.1621,     1.0895,     0.0089
     subsite,     0.9798,     0.2835,     0.7766,     0.9750,     0.1635,     1.0476,     0.0048
  laterality,     0.9836,     0.4204,     0.3672,     0.9750,     0.1415,     1.0857,     0.0086
   histology,     0.9743,     0.2366,     0.8454,     0.9750,     0.1207,     0.9933,    -0.0007
    behavior,     0.9931,     0.7015,     0.1155,     0.9750,     0.2091,     1.1814,     0.0181
       ntask,     0.9806,     0.9806,     0.8982,     0.9750,     0.1500,     1.0565,     0.0056
epoch 5
Stopping criterion not reached: 0.0181 > 0.0050
New alphas ['0.1766', '0.1713', '0.1536', '0.1199', '0.2470']
New ntask alpha ['0.1584']


training time: 558.40
        task,      micro,      macro,   abs_frac
        site,     0.9866,     0.5175,     0.3759
     subsite,     0.9869,     0.2203,     0.8101
  laterality,     0.9792,     0.4177,     0.3893
   histology,     0.9830,     0.2101,     0.9012
    behavior,     0.9818,     0.6559,     0.0831
       ntask,     0.9854,     0.9854,     0.9234

epoch 6 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9789,     0.5633,     0.2468,     0.9750,     0.1766,     1.0393,     0.0039
     subsite,     0.9749,     0.2905,     0.7506,     0.9750,     0.1713,     0.9989,    -0.0001
  laterality,     0.9818,     0.4196,     0.3202,     0.9750,     0.1536,     1.0679,     0.0068
   histology,     0.9725,     0.2374,     0.8386,     0.9750,     0.1199,     0.9754,    -0.0025
    behavior,     0.9905,     0.6960,     0.0912,     0.9750,     0.2470,     1.1546,     0.0155
       ntask,     0.9813,     0.9813,     0.8967,     0.9750,     0.1584,     1.0630,     0.0063
epoch 6
Stopping criterion not reached: 0.0155 > 0.0050
New alphas ['0.1835', '0.1711', '0.1640', '0.1169', '0.2852']
New ntask alpha ['0.1684']


training time: 561.22
        task,      micro,      macro,   abs_frac
        site,     0.9859,     0.5226,     0.3606
     subsite,     0.9866,     0.2222,     0.8047
  laterality,     0.9778,     0.4170,     0.3715
   histology,     0.9825,     0.2524,     0.8989
    behavior,     0.9765,     0.6653,     0.0604
       ntask,     0.9850,     0.9850,     0.9203

epoch 7 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9794,     0.5787,     0.2422,     0.9750,     0.1835,     1.0440,     0.0044
     subsite,     0.9765,     0.3228,     0.7437,     0.9750,     0.1711,     1.0153,     0.0015
  laterality,     0.9769,     0.4173,     0.2629,     0.9750,     0.1640,     1.0189,     0.0019
   histology,     0.9674,     0.2409,     0.8121,     0.9750,     0.1169,     0.9236,    -0.0076
    behavior,     0.9860,     0.6998,     0.0665,     0.9750,     0.2852,     1.1095,     0.0110
       ntask,     0.9773,     0.9773,     0.8795,     0.9750,     0.1684,     1.0234,     0.0023
epoch 7
Stopping criterion not reached: 0.0110 > 0.0050
New alphas ['0.1916', '0.1737', '0.1671', '0.1080', '0.3165']
New ntask alpha ['0.1724']


training time: 561.03
        task,      micro,      macro,   abs_frac
        site,     0.9854,     0.5293,     0.3471
     subsite,     0.9858,     0.2632,     0.8000
  laterality,     0.9777,     0.4171,     0.3588
   histology,     0.9842,     0.2238,     0.9013
    behavior,     0.9723,     0.6690,     0.0421
       ntask,     0.9849,     0.9849,     0.9192

epoch 8 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9785,     0.6036,     0.2337,     0.9750,     0.1916,     1.0348,     0.0035
     subsite,     0.9743,     0.3118,     0.7345,     0.9750,     0.1737,     0.9933,    -0.0007
  laterality,     0.9814,     0.4194,     0.3015,     0.9750,     0.1671,     1.0639,     0.0064
   histology,     0.9737,     0.2678,     0.8427,     0.9750,     0.1080,     0.9872,    -0.0013
    behavior,     0.9826,     0.7027,     0.0534,     0.9750,     0.3165,     1.0755,     0.0076
       ntask,     0.9794,     0.9794,     0.8870,     0.9750,     0.1724,     1.0437,     0.0044
epoch 8
Stopping criterion not reached: 0.0076 > 0.0050
New alphas ['0.1982', '0.1725', '0.1778', '0.1066', '0.3404']
New ntask alpha ['0.1799']


training time: 561.21
        task,      micro,      macro,   abs_frac
        site,     0.9850,     0.5543,     0.3362
     subsite,     0.9861,     0.2637,     0.7955
  laterality,     0.9762,     0.4163,     0.3435
   histology,     0.9847,     0.2773,     0.8990
    behavior,     0.9689,     0.6812,     0.0284
       ntask,     0.9848,     0.9848,     0.9167

epoch 9 validation
        task,      micro,      macro,   abs_frac, target_acc,      alpha,  scale_fac, stop_metric
        site,     0.9786,     0.5847,     0.2319,     0.9750,     0.1982,     1.0357,     0.0036
     subsite,     0.9743,     0.3298,     0.7288,     0.9750,     0.1725,     0.9930,    -0.0007
  laterality,     0.9778,     0.4178,     0.2722,     0.9750,     0.1778,     1.0279,     0.0028
   histology,     0.9745,     0.3244,     0.8418,     0.9750,     0.1066,     0.9951,    -0.0005
    behavior,     0.9781,     0.7011,     0.0327,     0.9750,     0.3404,     1.0308,     0.0031
       ntask,     0.9787,     0.9787,     0.8821,     0.9750,     0.1799,     1.0370,     0.0037
epoch 9
Stopping criterion reached: 0.0037 < 0.0050
Testing best saved model

file has been saved at savedmodels/../ntask_current/LA_modelfold0.h5
saving f1 scores to predictions/LA_modelfold0_scores.csv

train scores:
        task,      micro,      macro,   abs_frac
        site,     0.9858,     0.5479,     0.3223
     subsite,     0.9866,     0.2533,     0.7894
  laterality,     0.9794,     0.4180,     0.3525
   histology,     0.9862,     0.2868,     0.9041
    behavior,     0.9743,     0.6819,     0.0394
       ntask,     0.9878,     0.9878,     0.9267

val scores:
        task,      micro,      macro,   abs_frac
        site,     0.9786,     0.5847,     0.2319
     subsite,     0.9743,     0.3298,     0.7288
  laterality,     0.9778,     0.4178,     0.2722
   histology,     0.9745,     0.3244,     0.8418
    behavior,     0.9781,     0.7011,     0.0327
       ntask,     0.9787,     0.9787,     0.8821

test scores:
        task,      micro,      macro,   abs_frac
        site,     0.9813,     0.5996,     0.2049
     subsite,     0.9759,     0.3710,     0.7174
  laterality,     0.9795,     0.4188,     0.2507
   histology,     0.9866,     0.3836,     0.8294
    behavior,     0.9807,     0.6977,     0.0259
       ntask,     0.9863,     0.9863,     0.8686
writing csv
f1 scores have been saved to predictions/LA_modelfold0_scores.csv
saving full results to predictions/LA_modelfold0_*



writing csvs
files have been saved to this directory under the names predictions/LA_modelfold0_*
